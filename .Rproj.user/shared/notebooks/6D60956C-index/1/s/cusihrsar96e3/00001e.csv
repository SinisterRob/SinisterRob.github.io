"0","#| warning: false"
"0","bb_tourney %<>% "
"0","  merge(bb_seeds, by.x = c(""Season"", ""WTeamID""), by.y = c(""Season"", ""TeamID""), all.x = TRUE) %>% "
"0","  rename(""SeedW"" = ""Seed"") %>% "
"0","  merge(bb_seeds, by.x = c(""Season"", ""LTeamID""), by.y = c(""Season"", ""TeamID""), all.x = TRUE) %>% "
"0","  rename(""SeedL"" = ""Seed"") %>% "
"0","  mutate(SeedW = as.integer(gsub(""\\D"", """", SeedW)), SeedL = as.integer(gsub(""\\D"", """", SeedL))) %>% "
"0","  merge(bb_features, by.x = c(""Season"", ""WTeamID""), by.y = c(""Season"", ""TeamID""), all.x = TRUE) %>%   "
"0","  rename(""GapAvgW"" = ""GapAvg"", ""WinRatioW"" = ""WinRatio"") %>% "
"0","  merge(bb_features, by.x = c(""Season"", ""LTeamID""), by.y = c(""Season"", ""TeamID""), all.x = TRUE) %>% "
"0","  rename(""GapAvgL"" = ""GapAvg"", ""WinRatioL"" = ""WinRatio"") %>% "
"0","  select(-NumOT, -WLoc)"
"0",""
"0","# Adding a reversed version of the data to itself so we have both wins and losses."
"0",""
"0","bb_1 <- "
"0","  bb_tourney %>% "
"0","  rename(""TeamIdA"" = ""WTeamID"","
"0","         ""ScoreA"" = ""WScore"","
"0","         ""TeamIdB"" = ""LTeamID"","
"0","         ""ScoreB"" = ""LScore"","
"0","         ""SeedA"" = ""SeedW"","
"0","         ""SeedB"" = ""SeedL"","
"0","         ""WinRatioA"" = ""WinRatioW"","
"0","         ""WinRatioB"" = ""WinRatioL"","
"0","         ""GapAvgA"" = ""GapAvgW"","
"0","         ""GapAvgB"" = ""GapAvgL"")"
"0",""
"0","bb_2 <-"
"0","  bb_tourney %>% "
"0","  rename(""TeamIdB"" = ""WTeamID"","
"0","         ""ScoreB"" = ""WScore"","
"0","         ""TeamIdA"" = ""LTeamID"","
"0","         ""ScoreA"" = ""LScore"","
"0","         ""SeedB"" = ""SeedW"","
"0","         ""SeedA"" = ""SeedL"","
"0","         ""WinRatioB"" = ""WinRatioW"","
"0","         ""WinRatioA"" = ""WinRatioL"","
"0","         ""GapAvgB"" = ""GapAvgW"","
"0","         ""GapAvgA"" = ""GapAvgL"")"
"0",""
"0","bb <- rbind(bb_1, bb_2 %>% relocate(names(bb_1)))"
"0","  "
"0","bb %<>% mutate(SeedDiff = SeedA - SeedB,"
"0","               WinRatioDiff = WinRatioA - WinRatioB,"
"0","               GapAvgDiff = GapAvgA - GapAvgB,"
"0","               ScoreDiff = ScoreA - ScoreB,"
"0","               WinA = as.integer(ScoreDiff > 0))"
"0",""
"0","bb_train <-"
"0","  bb %>% "
"0","  select(""SeedA"", ""SeedB"", ""WinRatioA"", ""WinRatioB"", ""GapAvgA"", ""GapAvgB"", ""SeedDiff"", ""WinRatioDiff"", ""GapAvgDiff"", ""WinA"") %>% "
"0","  mutate(across(SeedA:GapAvgDiff, scale))"
"0",""
"0","rm(list = setdiff(ls(), c(""bb_train"", names(sessionInfo()$otherPkgs))))"
"0","gc()"
"1","      "
"1","    used"
"1","  (Mb)"
"1"," gc trigger"
"1","  (Mb)"
"1"," max used"
"1","  (Mb)"
"1","
Ncells"
"1"," 2698132"
"1"," 144.1"
"1","    5740074"
"1"," 306.6"
"1","  5740074"
"1"," 306.6"
"1","
Vcells"
"1"," 5404502"
"1","  41.3"
"1","   37593996"
"1"," 286.9"
"1"," 58572938"
"1"," 446.9"
"1","
"
