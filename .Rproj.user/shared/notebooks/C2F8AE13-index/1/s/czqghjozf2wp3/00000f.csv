"0","#| warning: false"
"0","cabin_sst_data <- imputed_sst_data %>% "
"0","  tidyr::separate(Cabin, into = c(""deck"", ""num"", ""side""), sep = ""/"", remove = FALSE, fill = ""right"") %>% "
"0","  mutate(deck = ifelse(deck == """", NA, deck)) %>% "
"0","  group_by(deck, num, side) %>% "
"0","  mutate(people_in_room = n(),"
"0","         CabinMult = ifelse(people_in_room > 1 & !is.na(deck), TRUE, FALSE)) %>% "
"0","  select(-c(Cabin, people_in_room)) %>% "
"0","  ungroup() %>% "
"0","  mutate(deck = factor(deck),"
"0","         num = as.numeric(num),"
"0","         side = factor(side))"
"0",""
"0","cabin_no_transport <- cabin_sst_data %>% select(-""Transported"")"
"0","cabin_transport <- cabin_sst_data %>% pull(""Transported"")"
"0",""
"0","imputed_cabin <- mice(cabin_no_transport, m = 1, printFlag = FALSE)"
"0","imputed_cabin_data <- complete(imputed_cabin, 1)"
"0","imputed_cabin_data$Transported <- cabin_transport"
"0","imputed_cabin_data <-"
"0","  imputed_cabin_data %>% "
"0","  mutate(HomePlanet = factor(HomePlanet, levels = unique(HomePlanet)),"
"0","         VIP = factor(VIP, levels = unique(VIP)),"
"0","         deck = factor(deck, levels = unique(deck)),"
"0","         side = factor(side, levels = unique(side)))"
"0",""
"0","num_model <- gam(Transported ~ s(num), data = imputed_cabin_data, family = binomial(link = ""logit""))"
"0","imputed_cabin_data$num_Pred <- predict(num_model, imputed_cabin_data, type = ""response"")"
